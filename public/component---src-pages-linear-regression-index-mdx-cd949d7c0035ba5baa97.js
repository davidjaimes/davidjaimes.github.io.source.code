(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{WJ7r:function(e,a,n){"use strict";n.r(a),n.d(a,"_frontmatter",(function(){return c})),n.d(a,"default",(function(){return p}));n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("91GP"),n("q1tI");var t=n("7ljp"),s=n("L12J");var c={},b={_frontmatter:c},o=s.a;function p(e){var a=e.components,n=function(e,a){if(null==e)return{};var n,t,s={},c=Object.keys(e);for(t=0;t<c.length;t++)n=c[t],a.indexOf(n)>=0||(s[n]=e[n]);return s}(e,["components"]);return Object(t.b)(o,Object.assign({},b,n,{components:a,mdxType:"MDXLayout"}),Object(t.b)("h1",{align:"center"},"Fitting a Line to Data"),Object(t.b)("p",{align:"center"},"From Hogg et al. 2010"),Object(t.b)("h2",null,"Exercise 1"),Object(t.b)("p",null,"Using the standard linear algebra method of this Section, fit a straight line $y = mx + b$ to the $x$, $y$, $\\sigma",Object(t.b)("em",{parentName:"p"},"y$ values for data points 5 through 20 in Table 1 on page 6. That is, ignore the first four data points, and also ignore the columns for $\\sigma_x$ and $\\rho"),"{xy}$. Make a plot showing the points, their uncertainties, and the best-fit line. Your plot should end up looking like Figure 1. What is the standard uncertainty variance $\\sigma^2_m$ on the slope of the line?"),Object(t.b)("p",null,"Table 1 on page 6:"),Object(t.b)("div",{className:"gatsby-highlight","data-language":"text"},Object(t.b)("pre",Object.assign({parentName:"div"},{className:"language-text"}),Object(t.b)("code",Object.assign({parentName:"pre"},{className:"language-text"}),"ID x y sig_y sig_x rho_xy\n1 201 592 61 9 -0.84\n2 244 401 25 4 0.31\n3 47 583 38 11 0.64\n4 287 402 15 7 -0.27\n5 203 495 21 5 -0.33\n6 58 173 15 9 0.67\n7 210 479 27 4 -0.02\n8 202 504 14 4 -0.05\n9 198 510 30 11 -0.84\n10 158 416 16 7 -0.69\n11 165 393 14 5 0.30\n12 201 442 25 5 -0.46\n13 157 317 52 5 -0.03\n14 131 311 16 6 0.50\n15 166 400 34 6 0.73\n16 160 337 31 5 -0.52\n17 186 423 42 9 0.90\n18 125 334 26 8 0.40\n19 218 533 16 6 -0.78\n20 146 344 22 5 -0.56"))),Object(t.b)("p",null,"Linear Regression Function:"),Object(t.b)("div",{className:"gatsby-highlight","data-language":"python"},Object(t.b)("pre",Object.assign({parentName:"div"},{className:"language-python"}),Object(t.b)("code",Object.assign({parentName:"pre"},{className:"language-python"}),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"def")," ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"linear"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"objectx",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," objecty",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," objectey",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token triple-quoted-string string"}),"'''\n    Returns (b, m) values from y = mx + b linear regression.\n    Parameters\n    ----------\n    objectx : array_like\n        Independent variable, usually labeled as the x values.\n    objecty : array_like\n        Dependent variable, usually labeled as the y values.\n    objectey : array_like\n        Gaussian uncertainties in the y direction.\n    Returns\n    -------\n    (b, eb, m, em) : scalars\n        There are two best-fit and their respective standard uncertainty\n        variances. The values are returned in a set.\n    '''"),"\n    ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"import")," numpy ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"as")," np\n    ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"from")," numpy",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"linalg ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"import")," inv\n\n    ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# Create matrices and solve the best-fit values."),"\n    Y ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," objecty\n    A ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," np",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"matrix",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"np",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"ones_like",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"Y",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," objectx",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"T\n    C ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," np",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"diag",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"pow"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"objectey",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n    X1 ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," inv",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"A",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"T @ inv",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"C",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," @ A",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n    X2 ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," A",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"T @ inv",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"C",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," @ Y\n    X ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),"  X2 @ X1\n    ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"return")," ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"X",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"item",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," np",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"sqrt",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"X1",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"item",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," X",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"item",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," np",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"sqrt",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"X1",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"item",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token number"}),"3"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")))),Object(t.b)("p",null,"Read the date, remove unwanted lines, and preform linear regression."),Object(t.b)("div",{className:"gatsby-highlight","data-language":"python"},Object(t.b)("pre",Object.assign({parentName:"div"},{className:"language-python"}),Object(t.b)("code",Object.assign({parentName:"pre"},{className:"language-python"}),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"import")," matplotlib",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"pyplot ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"as")," plt\n",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"import")," numpy ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"as")," np\n",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"import")," pandas ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"as")," pd\n\ndf ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," pd",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"read_csv",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'table1.dat'"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," sep",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"' '"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\ndf ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," df",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token number"}),"4"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),"\nb",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," eb",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," m",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," em ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," linear",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"df",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'x'"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," df",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'y'"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," df",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'sig_y'"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\nx ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," np",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"linspace",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token number"}),"300"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\ny ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," m ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," x ",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," b"))),Object(t.b)("p",null,"Plot the data:"),Object(t.b)("div",{className:"gatsby-highlight","data-language":"python"},Object(t.b)("pre",Object.assign({parentName:"div"},{className:"language-python"}),Object(t.b)("code",Object.assign({parentName:"pre"},{className:"language-python"}),"plt",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"errorbar",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"df",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'x'"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," df",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'y'"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," yerr",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),"df",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'sig_y'"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," label",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'Data'"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\nplt",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"plot",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"x",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," y",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," label",Object(t.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'Model'"),Object(t.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")))),Object(t.b)("p",null,Object(t.b)("img",Object.assign({parentName:"p"},{src:"./../images/exercise1.png",alt:"exercise1"}))))}p.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-linear-regression-index-mdx-cd949d7c0035ba5baa97.js.map