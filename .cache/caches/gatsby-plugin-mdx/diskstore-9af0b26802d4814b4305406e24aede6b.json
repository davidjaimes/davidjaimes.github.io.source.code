{"expireTime":9007200849928404000,"key":"gatsby-plugin-mdx-entire-payload-1e90854965168ea2686bee9a61d619c7-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/djaimes/davidjaimes.github.io.source.code/src/components/homepage.jsx\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":105,"offset":106},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":108},"end":{"line":5,"column":29,"offset":136},"indent":[]}},{"type":"import","value":"import { Alert } from 'react-bootstrap';","position":{"start":{"line":8,"column":1,"offset":139},"end":{"line":8,"column":41,"offset":179},"indent":[]}},{"type":"jsx","value":"<h1 align=\"center\" style={{marginTop: \"2em\"}}>Fitting a Line to Data with <b>Linear Algebra</b></h1>","position":{"start":{"line":10,"column":1,"offset":181},"end":{"line":10,"column":101,"offset":281},"indent":[]}},{"type":"jsx","value":"<br/><br/>","position":{"start":{"line":12,"column":1,"offset":283},"end":{"line":12,"column":11,"offset":293},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You have a set of ","position":{"start":{"line":14,"column":1,"offset":295},"end":{"line":14,"column":19,"offset":313},"indent":[]}},{"type":"inlineMath","value":"N > 2","data":{"hName":"span","hProperties":{"className":["math","math-inline"]},"hChildren":[{"type":"text","value":"N > 2"}]},"position":{"start":{"line":14,"column":19,"offset":313},"end":{"line":14,"column":26,"offset":320},"indent":[]}},{"type":"text","value":" points (","position":{"start":{"line":14,"column":26,"offset":320},"end":{"line":14,"column":35,"offset":329},"indent":[]}},{"type":"inlineMath","value":"x_i, y_i)","data":{"hName":"span","hProperties":{"className":["math","math-inline"]},"hChildren":[{"type":"text","value":"x_i, y_i)"}]},"position":{"start":{"line":14,"column":35,"offset":329},"end":{"line":14,"column":46,"offset":340},"indent":[]}},{"type":"text","value":", with known Gaussian uncertainties ","position":{"start":{"line":14,"column":46,"offset":340},"end":{"line":14,"column":82,"offset":376},"indent":[]}},{"type":"inlineMath","value":"\\sigma_{yi}","data":{"hName":"span","hProperties":{"className":["math","math-inline"]},"hChildren":[{"type":"text","value":"\\sigma_{yi}"}]},"position":{"start":{"line":14,"column":82,"offset":376},"end":{"line":14,"column":95,"offset":389},"indent":[]}},{"type":"text","value":" in the ","position":{"start":{"line":14,"column":95,"offset":389},"end":{"line":14,"column":103,"offset":397},"indent":[]}},{"type":"inlineMath","value":"y","data":{"hName":"span","hProperties":{"className":["math","math-inline"]},"hChildren":[{"type":"text","value":"y"}]},"position":{"start":{"line":14,"column":103,"offset":397},"end":{"line":14,"column":106,"offset":400},"indent":[]}},{"type":"text","value":" direction, and no uncertainty at all (that is, perfect knowledge) in the ","position":{"start":{"line":14,"column":106,"offset":400},"end":{"line":14,"column":180,"offset":474},"indent":[]}},{"type":"inlineMath","value":"x","data":{"hName":"span","hProperties":{"className":["math","math-inline"]},"hChildren":[{"type":"text","value":"x"}]},"position":{"start":{"line":14,"column":180,"offset":474},"end":{"line":14,"column":183,"offset":477},"indent":[]}},{"type":"text","value":" direction. You want to find the function ","position":{"start":{"line":14,"column":183,"offset":477},"end":{"line":14,"column":225,"offset":519},"indent":[]}},{"type":"inlineMath","value":"f(x)","data":{"hName":"span","hProperties":{"className":["math","math-inline"]},"hChildren":[{"type":"text","value":"f(x)"}]},"position":{"start":{"line":14,"column":225,"offset":519},"end":{"line":14,"column":231,"offset":525},"indent":[]}},{"type":"text","value":" of the form","position":{"start":{"line":14,"column":231,"offset":525},"end":{"line":14,"column":243,"offset":537},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":295},"end":{"line":14,"column":243,"offset":537},"indent":[]}},{"type":"math","value":"\n<Alert variant={'info'}>\n    This exercise is adapted from <strong>Data analysis recipes: Fitting a model to data</strong> by David W. Hogg and Jo Bovy and Dustin Lang, 2010, 1008.4686, arXiv, astro-ph.IM, https://arxiv.org/abs/1008.4686.\n</Alert>\n\n<br/>\n\n## Important Equations\n\n","data":{"hName":"div","hProperties":{"className":["math","math-display"]},"hChildren":[{"type":"text","value":"\n<Alert variant={'info'}>\n    This exercise is adapted from <strong>Data analysis recipes: Fitting a model to data</strong> by David W. Hogg and Jo Bovy and Dustin Lang, 2010, 1008.4686, arXiv, astro-ph.IM, https://arxiv.org/abs/1008.4686.\n</Alert>\n\n<br/>\n\n## Important Equations\n\n"}]},"position":{"start":{"line":16,"column":1,"offset":539},"end":{"line":26,"column":3,"offset":825},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"\\begin{bmatrix}\n   b ","position":{"start":{"line":27,"column":1,"offset":826},"end":{"line":28,"column":6,"offset":847},"indent":[1]}},{"type":"text","value":"\\","position":{"start":{"line":28,"column":6,"offset":847},"end":{"line":28,"column":8,"offset":849},"indent":[]}},{"type":"text","value":"\n   m\n\\end{bmatrix}\n= X =\n\\begin{bmatrix}\n    A^{\\top} C^{-1} A\n\\end{bmatrix}^{-1}\n\\begin{bmatrix}\n    A^{\\top} C^{-1} Y\n\\end{bmatrix}","position":{"start":{"line":28,"column":8,"offset":849},"end":{"line":37,"column":14,"offset":983},"indent":[1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":27,"column":1,"offset":826},"end":{"line":37,"column":14,"offset":983},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"math","value":"\n","data":{"hName":"div","hProperties":{"className":["math","math-display"]},"hChildren":[{"type":"text","value":"\n"}]},"position":{"start":{"line":38,"column":1,"offset":984},"end":{"line":40,"column":3,"offset":990},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"\\sigma^2 = \n\\begin{bmatrix}\n    \\sigma^{2}","position":{"start":{"line":41,"column":1,"offset":991},"end":{"line":43,"column":15,"offset":1033},"indent":[1,1]}},{"type":"emphasis","children":[{"type":"text","value":"{x} & \\rho","position":{"start":{"line":43,"column":16,"offset":1034},"end":{"line":43,"column":26,"offset":1044},"indent":[]}}],"position":{"start":{"line":43,"column":15,"offset":1033},"end":{"line":43,"column":27,"offset":1045},"indent":[]}},{"type":"text","value":"{xy}\\sigma","position":{"start":{"line":43,"column":27,"offset":1045},"end":{"line":43,"column":37,"offset":1055},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"x\\sigma_y ","position":{"start":{"line":43,"column":38,"offset":1056},"end":{"line":43,"column":48,"offset":1066},"indent":[]}},{"type":"text","value":"\\","position":{"start":{"line":43,"column":48,"offset":1066},"end":{"line":43,"column":50,"offset":1068},"indent":[]}},{"type":"text","value":"\n    \\rho","position":{"start":{"line":43,"column":50,"offset":1068},"end":{"line":44,"column":9,"offset":1077},"indent":[1]}}],"position":{"start":{"line":43,"column":37,"offset":1055},"end":{"line":44,"column":10,"offset":1078},"indent":[1]}},{"type":"text","value":"{xy}\\sigma","position":{"start":{"line":44,"column":10,"offset":1078},"end":{"line":44,"column":20,"offset":1088},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"x\\sigma_y & \\sigma^{2}","position":{"start":{"line":44,"column":21,"offset":1089},"end":{"line":44,"column":43,"offset":1111},"indent":[]}}],"position":{"start":{"line":44,"column":20,"offset":1088},"end":{"line":44,"column":44,"offset":1112},"indent":[]}},{"type":"text","value":"{y}","position":{"start":{"line":44,"column":44,"offset":1112},"end":{"line":44,"column":47,"offset":1115},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":991},"end":{"line":44,"column":47,"offset":1115},"indent":[1,1,1]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"\\end{bmatrix}","position":{"start":{"line":45,"column":1,"offset":1116},"end":{"line":45,"column":14,"offset":1129},"indent":[]}}],"position":{"start":{"line":45,"column":1,"offset":1116},"end":{"line":46,"column":2,"offset":1131},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"\\begin{bmatrix}\n    A^{\\top} C^{-1} A\n\\end{bmatrix}^{-1}","position":{"start":{"line":47,"column":1,"offset":1132},"end":{"line":49,"column":19,"offset":1188},"indent":[1,1]}}],"position":{"start":{"line":47,"column":1,"offset":1132},"end":{"line":49,"column":19,"offset":1188},"indent":[1,1]}},{"type":"math","value":"\n<br/>\n\n## Exercise 1\n\nUsing the standard linear algebra method of this Section, fit a straight line $y = mx + b$ to the $x$, $y$, $\\sigma_y$ values for data points 5 through 20 in Table 1 on page 6. That is, ignore the first four data points, and also ignore the columns for $\\sigma_x$ and $\\rho_{xy}$. Make a plot showing the points, their uncertainties, and the best-fit line. Your plot should end up looking like Figure 1. What is the standard uncertainty variance $\\sigma^2_m$ on the slope of the line?\n\nTable 1 on page 6:\n```\nID    x    y  sig_y  sig_x  rho_xy\n 1  201  592     61      9   -0.84\n 2  244  401     25      4    0.31\n 3   47  583     38     11    0.64\n 4  287  402     15      7   -0.27\n 5  203  495     21      5   -0.33\n 6   58  173     15      9    0.67\n 7  210  479     27      4   -0.02\n 8  202  504     14      4   -0.05\n 9  198  510     30     11   -0.84\n10  158  416     16      7   -0.69\n11  165  393     14      5    0.30\n12  201  442     25      5   -0.46\n13  157  317     52      5   -0.03\n14  131  311     16      6    0.50\n15  166  400     34      6    0.73\n16  160  337     31      5   -0.52\n17  186  423     42      9    0.90\n18  125  334     26      8    0.40\n19  218  533     16      6   -0.78\n20  146  344     22      5   -0.56\n```\n\n<br/>\n\n## Function\n\n```python\ndef linear(objectx, objecty, objectey):\n    '''\n    Returns (b, m) values from y = mx + b linear regression.\n    Parameters\n    ----------\n    objectx : array_like\n        Independent variable, usually labeled as the x values.\n    objecty : array_like\n        Dependent variable, usually labeled as the y values.\n    objectey : array_like\n        Gaussian uncertainties in the y direction.\n    Returns\n    -------\n    (b, eb, m, em) : scalars\n        There are two best-fit and their respective standard uncertainty\n        variances. The values are returned in a set.\n    '''\n    import numpy as np\n    from numpy.linalg import inv\n\n    # Create matrices and solve the best-fit values.\n    Y = objecty\n    A = np.matrix([np.ones_like(Y), objectx]).T\n    C = np.diag(pow(objectey, 2))\n    X1 = inv(A.T @ inv(C) @ A)\n    X2 = A.T @ inv(C) @ Y\n    X =  X2 @ X1\n    return (X.item(0), np.sqrt(X1.item(0)), X.item(1), np.sqrt(X1.item(3)))\n```\n\n<br/>\n\n## Results\n\nRead the date, remove unwanted lines, and preform linear regression.\n```python\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\ndf = pd.read_csv('table1.dat', sep=' ')\ndf = df[4:]\nb, eb, m, em = linear(df['x'], df['y'], df['sig_y'])\nx = np.linspace(0, 300)\ny = m * x + b\n```\n\nPlot the data:\n```python\nplt.errorbar(df['x'], df['y'], yerr=df['sig_y'], label='Data')\nplt.plot(x, y, label='Model')\n```\n\n![exercise1](../../images/exercise1.png)\n\n\nexport const _frontmatter = {}","data":{"hName":"div","hProperties":{"className":["math","math-display"]},"hChildren":[{"type":"text","value":"\n<br/>\n\n## Exercise 1\n\nUsing the standard linear algebra method of this Section, fit a straight line $y = mx + b$ to the $x$, $y$, $\\sigma_y$ values for data points 5 through 20 in Table 1 on page 6. That is, ignore the first four data points, and also ignore the columns for $\\sigma_x$ and $\\rho_{xy}$. Make a plot showing the points, their uncertainties, and the best-fit line. Your plot should end up looking like Figure 1. What is the standard uncertainty variance $\\sigma^2_m$ on the slope of the line?\n\nTable 1 on page 6:\n```\nID    x    y  sig_y  sig_x  rho_xy\n 1  201  592     61      9   -0.84\n 2  244  401     25      4    0.31\n 3   47  583     38     11    0.64\n 4  287  402     15      7   -0.27\n 5  203  495     21      5   -0.33\n 6   58  173     15      9    0.67\n 7  210  479     27      4   -0.02\n 8  202  504     14      4   -0.05\n 9  198  510     30     11   -0.84\n10  158  416     16      7   -0.69\n11  165  393     14      5    0.30\n12  201  442     25      5   -0.46\n13  157  317     52      5   -0.03\n14  131  311     16      6    0.50\n15  166  400     34      6    0.73\n16  160  337     31      5   -0.52\n17  186  423     42      9    0.90\n18  125  334     26      8    0.40\n19  218  533     16      6   -0.78\n20  146  344     22      5   -0.56\n```\n\n<br/>\n\n## Function\n\n```python\ndef linear(objectx, objecty, objectey):\n    '''\n    Returns (b, m) values from y = mx + b linear regression.\n    Parameters\n    ----------\n    objectx : array_like\n        Independent variable, usually labeled as the x values.\n    objecty : array_like\n        Dependent variable, usually labeled as the y values.\n    objectey : array_like\n        Gaussian uncertainties in the y direction.\n    Returns\n    -------\n    (b, eb, m, em) : scalars\n        There are two best-fit and their respective standard uncertainty\n        variances. The values are returned in a set.\n    '''\n    import numpy as np\n    from numpy.linalg import inv\n\n    # Create matrices and solve the best-fit values.\n    Y = objecty\n    A = np.matrix([np.ones_like(Y), objectx]).T\n    C = np.diag(pow(objectey, 2))\n    X1 = inv(A.T @ inv(C) @ A)\n    X2 = A.T @ inv(C) @ Y\n    X =  X2 @ X1\n    return (X.item(0), np.sqrt(X1.item(0)), X.item(1), np.sqrt(X1.item(3)))\n```\n\n<br/>\n\n## Results\n\nRead the date, remove unwanted lines, and preform linear regression.\n```python\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\ndf = pd.read_csv('table1.dat', sep=' ')\ndf = df[4:]\nb, eb, m, em = linear(df['x'], df['y'], df['sig_y'])\nx = np.linspace(0, 300)\ny = m * x + b\n```\n\nPlot the data:\n```python\nplt.errorbar(df['x'], df['y'], yerr=df['sig_y'], label='Data')\nplt.plot(x, y, label='Model')\n```\n\n![exercise1](../../images/exercise1.png)\n\n\nexport const _frontmatter = {}"}]},"position":{"start":{"line":50,"column":1,"offset":1189},"end":{"line":144,"column":31,"offset":3948},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":144,"column":31,"offset":3948}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/djaimes/davidjaimes.github.io.source.code/src/components/homepage.jsx\"\nimport { Alert } from 'react-bootstrap';\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  \n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n    <h1 align=\"center\" style={{\n      marginTop: \"2em\"\n    }}>Fitting a Line to Data with <b>Linear Algebra</b></h1>\n    <br /><br />\n    <p>{`You have a set of `}<span parentName=\"p\" {...{\n        \"className\": \"math math-inline\"\n      }}><span parentName=\"span\" {...{\n          \"className\": \"katex\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"katex-mathml\"\n          }}><math parentName=\"span\" {...{\n              \"xmlns\": \"http://www.w3.org/1998/Math/MathML\"\n            }}><semantics parentName=\"math\"><mrow parentName=\"semantics\"><mi parentName=\"mrow\">{`N`}</mi><mo parentName=\"mrow\">{`>`}</mo><mn parentName=\"mrow\">{`2`}</mn></mrow><annotation parentName=\"semantics\" {...{\n                  \"encoding\": \"application/x-tex\"\n                }}>{`N > 2`}</annotation></semantics></math></span><span parentName=\"span\" {...{\n            \"className\": \"katex-html\",\n            \"aria-hidden\": \"true\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"base\"\n            }}><span parentName=\"span\" {...{\n                \"className\": \"strut\",\n                \"style\": {\n                  \"height\": \"0.72243em\",\n                  \"verticalAlign\": \"-0.0391em\"\n                }\n              }}></span><span parentName=\"span\" {...{\n                \"className\": \"mord mathdefault\",\n                \"style\": {\n                  \"marginRight\": \"0.10903em\"\n                }\n              }}>{`N`}</span><span parentName=\"span\" {...{\n                \"className\": \"mspace\",\n                \"style\": {\n                  \"marginRight\": \"0.2777777777777778em\"\n                }\n              }}></span><span parentName=\"span\" {...{\n                \"className\": \"mrel\"\n              }}>{`>`}</span><span parentName=\"span\" {...{\n                \"className\": \"mspace\",\n                \"style\": {\n                  \"marginRight\": \"0.2777777777777778em\"\n                }\n              }}></span></span><span parentName=\"span\" {...{\n              \"className\": \"base\"\n            }}><span parentName=\"span\" {...{\n                \"className\": \"strut\",\n                \"style\": {\n                  \"height\": \"0.64444em\",\n                  \"verticalAlign\": \"0em\"\n                }\n              }}></span><span parentName=\"span\" {...{\n                \"className\": \"mord\"\n              }}>{`2`}</span></span></span></span></span>{` points (`}<span parentName=\"p\" {...{\n        \"className\": \"math math-inline\"\n      }}><span parentName=\"span\" {...{\n          \"className\": \"katex\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"katex-mathml\"\n          }}><math parentName=\"span\" {...{\n              \"xmlns\": \"http://www.w3.org/1998/Math/MathML\"\n            }}><semantics parentName=\"math\"><mrow parentName=\"semantics\"><msub parentName=\"mrow\"><mi parentName=\"msub\">{`x`}</mi><mi parentName=\"msub\">{`i`}</mi></msub><mo parentName=\"mrow\" {...{\n                    \"separator\": \"true\"\n                  }}>{`,`}</mo><msub parentName=\"mrow\"><mi parentName=\"msub\">{`y`}</mi><mi parentName=\"msub\">{`i`}</mi></msub><mo parentName=\"mrow\" {...{\n                    \"stretchy\": \"false\"\n                  }}>{`)`}</mo></mrow><annotation parentName=\"semantics\" {...{\n                  \"encoding\": \"application/x-tex\"\n                }}>{`x_i, y_i)`}</annotation></semantics></math></span><span parentName=\"span\" {...{\n            \"className\": \"katex-html\",\n            \"aria-hidden\": \"true\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"base\"\n            }}><span parentName=\"span\" {...{\n                \"className\": \"strut\",\n                \"style\": {\n                  \"height\": \"1em\",\n                  \"verticalAlign\": \"-0.25em\"\n                }\n              }}></span><span parentName=\"span\" {...{\n                \"className\": \"mord\"\n              }}><span parentName=\"span\" {...{\n                  \"className\": \"mord mathdefault\"\n                }}>{`x`}</span><span parentName=\"span\" {...{\n                  \"className\": \"msupsub\"\n                }}><span parentName=\"span\" {...{\n                    \"className\": \"vlist-t vlist-t2\"\n                  }}><span parentName=\"span\" {...{\n                      \"className\": \"vlist-r\"\n                    }}><span parentName=\"span\" {...{\n                        \"className\": \"vlist\",\n                        \"style\": {\n                          \"height\": \"0.31166399999999994em\"\n                        }\n                      }}><span parentName=\"span\" {...{\n                          \"style\": {\n                            \"top\": \"-2.5500000000000003em\",\n                            \"marginLeft\": \"0em\",\n                            \"marginRight\": \"0.05em\"\n                          }\n                        }}><span parentName=\"span\" {...{\n                            \"className\": \"pstrut\",\n                            \"style\": {\n                              \"height\": \"2.7em\"\n                            }\n                          }}></span><span parentName=\"span\" {...{\n                            \"className\": \"sizing reset-size6 size3 mtight\"\n                          }}><span parentName=\"span\" {...{\n                              \"className\": \"mord mathdefault mtight\"\n                            }}>{`i`}</span></span></span></span><span parentName=\"span\" {...{\n                        \"className\": \"vlist-s\"\n                      }}>{`​`}</span></span><span parentName=\"span\" {...{\n                      \"className\": \"vlist-r\"\n                    }}><span parentName=\"span\" {...{\n                        \"className\": \"vlist\",\n                        \"style\": {\n                          \"height\": \"0.15em\"\n                        }\n                      }}><span parentName=\"span\"></span></span></span></span></span></span><span parentName=\"span\" {...{\n                \"className\": \"mpunct\"\n              }}>{`,`}</span><span parentName=\"span\" {...{\n                \"className\": \"mspace\",\n                \"style\": {\n                  \"marginRight\": \"0.16666666666666666em\"\n                }\n              }}></span><span parentName=\"span\" {...{\n                \"className\": \"mord\"\n              }}><span parentName=\"span\" {...{\n                  \"className\": \"mord mathdefault\",\n                  \"style\": {\n                    \"marginRight\": \"0.03588em\"\n                  }\n                }}>{`y`}</span><span parentName=\"span\" {...{\n                  \"className\": \"msupsub\"\n                }}><span parentName=\"span\" {...{\n                    \"className\": \"vlist-t vlist-t2\"\n                  }}><span parentName=\"span\" {...{\n                      \"className\": \"vlist-r\"\n                    }}><span parentName=\"span\" {...{\n                        \"className\": \"vlist\",\n                        \"style\": {\n                          \"height\": \"0.31166399999999994em\"\n                        }\n                      }}><span parentName=\"span\" {...{\n                          \"style\": {\n                            \"top\": \"-2.5500000000000003em\",\n                            \"marginLeft\": \"-0.03588em\",\n                            \"marginRight\": \"0.05em\"\n                          }\n                        }}><span parentName=\"span\" {...{\n                            \"className\": \"pstrut\",\n                            \"style\": {\n                              \"height\": \"2.7em\"\n                            }\n                          }}></span><span parentName=\"span\" {...{\n                            \"className\": \"sizing reset-size6 size3 mtight\"\n                          }}><span parentName=\"span\" {...{\n                              \"className\": \"mord mathdefault mtight\"\n                            }}>{`i`}</span></span></span></span><span parentName=\"span\" {...{\n                        \"className\": \"vlist-s\"\n                      }}>{`​`}</span></span><span parentName=\"span\" {...{\n                      \"className\": \"vlist-r\"\n                    }}><span parentName=\"span\" {...{\n                        \"className\": \"vlist\",\n                        \"style\": {\n                          \"height\": \"0.15em\"\n                        }\n                      }}><span parentName=\"span\"></span></span></span></span></span></span><span parentName=\"span\" {...{\n                \"className\": \"mclose\"\n              }}>{`)`}</span></span></span></span></span>{`, with known Gaussian uncertainties `}<span parentName=\"p\" {...{\n        \"className\": \"math math-inline\"\n      }}><span parentName=\"span\" {...{\n          \"className\": \"katex\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"katex-mathml\"\n          }}><math parentName=\"span\" {...{\n              \"xmlns\": \"http://www.w3.org/1998/Math/MathML\"\n            }}><semantics parentName=\"math\"><mrow parentName=\"semantics\"><msub parentName=\"mrow\"><mi parentName=\"msub\">{`σ`}</mi><mrow parentName=\"msub\"><mi parentName=\"mrow\">{`y`}</mi><mi parentName=\"mrow\">{`i`}</mi></mrow></msub></mrow><annotation parentName=\"semantics\" {...{\n                  \"encoding\": \"application/x-tex\"\n                }}>{`\\\\sigma_{yi}`}</annotation></semantics></math></span><span parentName=\"span\" {...{\n            \"className\": \"katex-html\",\n            \"aria-hidden\": \"true\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"base\"\n            }}><span parentName=\"span\" {...{\n                \"className\": \"strut\",\n                \"style\": {\n                  \"height\": \"0.716668em\",\n                  \"verticalAlign\": \"-0.286108em\"\n                }\n              }}></span><span parentName=\"span\" {...{\n                \"className\": \"mord\"\n              }}><span parentName=\"span\" {...{\n                  \"className\": \"mord mathdefault\",\n                  \"style\": {\n                    \"marginRight\": \"0.03588em\"\n                  }\n                }}>{`σ`}</span><span parentName=\"span\" {...{\n                  \"className\": \"msupsub\"\n                }}><span parentName=\"span\" {...{\n                    \"className\": \"vlist-t vlist-t2\"\n                  }}><span parentName=\"span\" {...{\n                      \"className\": \"vlist-r\"\n                    }}><span parentName=\"span\" {...{\n                        \"className\": \"vlist\",\n                        \"style\": {\n                          \"height\": \"0.311664em\"\n                        }\n                      }}><span parentName=\"span\" {...{\n                          \"style\": {\n                            \"top\": \"-2.5500000000000003em\",\n                            \"marginLeft\": \"-0.03588em\",\n                            \"marginRight\": \"0.05em\"\n                          }\n                        }}><span parentName=\"span\" {...{\n                            \"className\": \"pstrut\",\n                            \"style\": {\n                              \"height\": \"2.7em\"\n                            }\n                          }}></span><span parentName=\"span\" {...{\n                            \"className\": \"sizing reset-size6 size3 mtight\"\n                          }}><span parentName=\"span\" {...{\n                              \"className\": \"mord mtight\"\n                            }}><span parentName=\"span\" {...{\n                                \"className\": \"mord mathdefault mtight\",\n                                \"style\": {\n                                  \"marginRight\": \"0.03588em\"\n                                }\n                              }}>{`y`}</span><span parentName=\"span\" {...{\n                                \"className\": \"mord mathdefault mtight\"\n                              }}>{`i`}</span></span></span></span></span><span parentName=\"span\" {...{\n                        \"className\": \"vlist-s\"\n                      }}>{`​`}</span></span><span parentName=\"span\" {...{\n                      \"className\": \"vlist-r\"\n                    }}><span parentName=\"span\" {...{\n                        \"className\": \"vlist\",\n                        \"style\": {\n                          \"height\": \"0.286108em\"\n                        }\n                      }}><span parentName=\"span\"></span></span></span></span></span></span></span></span></span></span>{` in the `}<span parentName=\"p\" {...{\n        \"className\": \"math math-inline\"\n      }}><span parentName=\"span\" {...{\n          \"className\": \"katex\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"katex-mathml\"\n          }}><math parentName=\"span\" {...{\n              \"xmlns\": \"http://www.w3.org/1998/Math/MathML\"\n            }}><semantics parentName=\"math\"><mrow parentName=\"semantics\"><mi parentName=\"mrow\">{`y`}</mi></mrow><annotation parentName=\"semantics\" {...{\n                  \"encoding\": \"application/x-tex\"\n                }}>{`y`}</annotation></semantics></math></span><span parentName=\"span\" {...{\n            \"className\": \"katex-html\",\n            \"aria-hidden\": \"true\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"base\"\n            }}><span parentName=\"span\" {...{\n                \"className\": \"strut\",\n                \"style\": {\n                  \"height\": \"0.625em\",\n                  \"verticalAlign\": \"-0.19444em\"\n                }\n              }}></span><span parentName=\"span\" {...{\n                \"className\": \"mord mathdefault\",\n                \"style\": {\n                  \"marginRight\": \"0.03588em\"\n                }\n              }}>{`y`}</span></span></span></span></span>{` direction, and no uncertainty at all (that is, perfect knowledge) in the `}<span parentName=\"p\" {...{\n        \"className\": \"math math-inline\"\n      }}><span parentName=\"span\" {...{\n          \"className\": \"katex\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"katex-mathml\"\n          }}><math parentName=\"span\" {...{\n              \"xmlns\": \"http://www.w3.org/1998/Math/MathML\"\n            }}><semantics parentName=\"math\"><mrow parentName=\"semantics\"><mi parentName=\"mrow\">{`x`}</mi></mrow><annotation parentName=\"semantics\" {...{\n                  \"encoding\": \"application/x-tex\"\n                }}>{`x`}</annotation></semantics></math></span><span parentName=\"span\" {...{\n            \"className\": \"katex-html\",\n            \"aria-hidden\": \"true\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"base\"\n            }}><span parentName=\"span\" {...{\n                \"className\": \"strut\",\n                \"style\": {\n                  \"height\": \"0.43056em\",\n                  \"verticalAlign\": \"0em\"\n                }\n              }}></span><span parentName=\"span\" {...{\n                \"className\": \"mord mathdefault\"\n              }}>{`x`}</span></span></span></span></span>{` direction. You want to find the function `}<span parentName=\"p\" {...{\n        \"className\": \"math math-inline\"\n      }}><span parentName=\"span\" {...{\n          \"className\": \"katex\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"katex-mathml\"\n          }}><math parentName=\"span\" {...{\n              \"xmlns\": \"http://www.w3.org/1998/Math/MathML\"\n            }}><semantics parentName=\"math\"><mrow parentName=\"semantics\"><mi parentName=\"mrow\">{`f`}</mi><mo parentName=\"mrow\" {...{\n                    \"stretchy\": \"false\"\n                  }}>{`(`}</mo><mi parentName=\"mrow\">{`x`}</mi><mo parentName=\"mrow\" {...{\n                    \"stretchy\": \"false\"\n                  }}>{`)`}</mo></mrow><annotation parentName=\"semantics\" {...{\n                  \"encoding\": \"application/x-tex\"\n                }}>{`f(x)`}</annotation></semantics></math></span><span parentName=\"span\" {...{\n            \"className\": \"katex-html\",\n            \"aria-hidden\": \"true\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"base\"\n            }}><span parentName=\"span\" {...{\n                \"className\": \"strut\",\n                \"style\": {\n                  \"height\": \"1em\",\n                  \"verticalAlign\": \"-0.25em\"\n                }\n              }}></span><span parentName=\"span\" {...{\n                \"className\": \"mord mathdefault\",\n                \"style\": {\n                  \"marginRight\": \"0.10764em\"\n                }\n              }}>{`f`}</span><span parentName=\"span\" {...{\n                \"className\": \"mopen\"\n              }}>{`(`}</span><span parentName=\"span\" {...{\n                \"className\": \"mord mathdefault\"\n              }}>{`x`}</span><span parentName=\"span\" {...{\n                \"className\": \"mclose\"\n              }}>{`)`}</span></span></span></span></span>{` of the form`}</p>\n    <div {...{\n      \"className\": \"math math-display\"\n    }}><span parentName=\"div\" {...{\n        \"className\": \"katex-error\",\n        \"title\": \"ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 251: …</Alert> <br/> #̲# Important Equ…\",\n        \"style\": {\n          \"color\": \"#cc0000\"\n        }\n      }}>{`<Alert variant={'info'}> This exercise is adapted from <strong>Data analysis recipes: Fitting a model to data</strong> by David W. Hogg and Jo Bovy and Dustin Lang, 2010, 1008.4686, arXiv, astro-ph.IM, https://arxiv.org/abs/1008.4686. </Alert> <br/> ## Important Equations`}</span></div>\n    <p>{`\\\\begin{bmatrix}\nb `}{`\\\\`}{`\nm\n\\\\end{bmatrix}\n= X =\n\\\\begin{bmatrix}\nA^{\\\\top} C^{-1} A\n\\\\end{bmatrix}^{-1}\n\\\\begin{bmatrix}\nA^{\\\\top} C^{-1} Y\n\\\\end{bmatrix}`}</p>\n    <div {...{\n      \"className\": \"math math-display\"\n    }}><span parentName=\"div\" {...{\n        \"className\": \"katex-display\"\n      }}><span parentName=\"span\" {...{\n          \"className\": \"katex\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"katex-mathml\"\n          }}><math parentName=\"span\" {...{\n              \"xmlns\": \"http://www.w3.org/1998/Math/MathML\"\n            }}><semantics parentName=\"math\"><mrow parentName=\"semantics\"></mrow><annotation parentName=\"semantics\" {...{\n                  \"encoding\": \"application/x-tex\"\n                }}></annotation></semantics></math></span><span parentName=\"span\" {...{\n            \"className\": \"katex-html\",\n            \"aria-hidden\": \"true\"\n          }}></span></span></span></div>\n    <p>{`\\\\sigma^2 =\n\\\\begin{bmatrix}\n\\\\sigma^{2}`}<em parentName=\"p\">{`{x} & \\\\rho`}</em>{`{xy}\\\\sigma`}<em parentName=\"p\">{`x\\\\sigma_y `}{`\\\\`}{`\n\\\\rho`}</em>{`{xy}\\\\sigma`}<em parentName=\"p\">{`x\\\\sigma_y & \\\\sigma^{2}`}</em>{`{y}`}</p>\n    <h1>{`\\\\end{bmatrix}`}</h1>\n    <p>{`\\\\begin{bmatrix}\nA^{\\\\top} C^{-1} A\n\\\\end{bmatrix}^{-1}`}</p>\n    <div {...{\n      \"className\": \"math math-display\"\n    }}><span parentName=\"div\" {...{\n        \"className\": \"katex-error\",\n        \"title\": \"ParseError: KaTeX parse error: Expected 'EOF', got '#' at position 7: <br/> #̲# Exercise 1 Us…\",\n        \"style\": {\n          \"color\": \"#cc0000\"\n        }\n      }}>{`<br/> ## Exercise 1 Using the standard linear algebra method of this Section, fit a straight line $y = mx + b$ to the $x$, $y$, $\\\\sigma_y$ values for data points 5 through 20 in Table 1 on page 6. That is, ignore the first four data points, and also ignore the columns for $\\\\sigma_x$ and $\\\\rho_{xy}$. Make a plot showing the points, their uncertainties, and the best-fit line. Your plot should end up looking like Figure 1. What is the standard uncertainty variance $\\\\sigma^2_m$ on the slope of the line? Table 1 on page 6: \\`\\`\\` ID x y sig_y sig_x rho_xy 1 201 592 61 9 -0.84 2 244 401 25 4 0.31 3 47 583 38 11 0.64 4 287 402 15 7 -0.27 5 203 495 21 5 -0.33 6 58 173 15 9 0.67 7 210 479 27 4 -0.02 8 202 504 14 4 -0.05 9 198 510 30 11 -0.84 10 158 416 16 7 -0.69 11 165 393 14 5 0.30 12 201 442 25 5 -0.46 13 157 317 52 5 -0.03 14 131 311 16 6 0.50 15 166 400 34 6 0.73 16 160 337 31 5 -0.52 17 186 423 42 9 0.90 18 125 334 26 8 0.40 19 218 533 16 6 -0.78 20 146 344 22 5 -0.56 \\`\\`\\` <br/> ## Function \\`\\`\\`python def linear(objectx, objecty, objectey): ''' Returns (b, m) values from y = mx + b linear regression. Parameters ---------- objectx : array_like Independent variable, usually labeled as the x values. objecty : array_like Dependent variable, usually labeled as the y values. objectey : array_like Gaussian uncertainties in the y direction. Returns ------- (b, eb, m, em) : scalars There are two best-fit and their respective standard uncertainty variances. The values are returned in a set. ''' import numpy as np from numpy.linalg import inv # Create matrices and solve the best-fit values. Y = objecty A = np.matrix([np.ones_like(Y), objectx]).T C = np.diag(pow(objectey, 2)) X1 = inv(A.T @ inv(C) @ A) X2 = A.T @ inv(C) @ Y X = X2 @ X1 return (X.item(0), np.sqrt(X1.item(0)), X.item(1), np.sqrt(X1.item(3))) \\`\\`\\` <br/> ## Results Read the date, remove unwanted lines, and preform linear regression. \\`\\`\\`python import matplotlib.pyplot as plt import numpy as np import pandas as pd df = pd.read_csv('table1.dat', sep=' ') df = df[4:] b, eb, m, em = linear(df['x'], df['y'], df['sig_y']) x = np.linspace(0, 300) y = m * x + b \\`\\`\\` Plot the data: \\`\\`\\`python plt.errorbar(df['x'], df['y'], yerr=df['sig_y'], label='Data') plt.plot(x, y, label='Model') \\`\\`\\` ![exercise1](../../images/exercise1.png) export const _frontmatter = {}`}</span></div>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}